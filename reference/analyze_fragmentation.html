<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Provides fragment ends analysis — analyze_fragmentation • ctDNAtools</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Provides fragment ends analysis — analyze_fragmentation" />
<meta property="og:description" content="Calculates the number of fragment ends and the Windowed Protection Score (WPS) in genomic tiles within targets" />
<meta property="og:image" content="https://alkodsi.github.io/ctDNAtools/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ctDNAtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ctDNAtools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/alkodsi/ctDNAtools">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Provides fragment ends analysis</h1>
    <small class="dont-index">Source: <a href='https://github.com/alkodsi/ctDNAtools/blob/master/R/analyze_fragmentation.R'><code>R/analyze_fragmentation.R</code></a></small>
    <div class="hidden name"><code>analyze_fragmentation.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates the number of fragment ends and the Windowed Protection Score (WPS) in genomic tiles within targets</p>
    </div>

    <pre class="usage"><span class='fu'>analyze_fragmentation</span>(<span class='no'>bam</span>, <span class='no'>targets</span>, <span class='kw'>tag</span> <span class='kw'>=</span> <span class='st'>""</span>, <span class='kw'>window_size</span> <span class='kw'>=</span> <span class='fl'>120</span>,
  <span class='kw'>step_size</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>min_size</span> <span class='kw'>=</span> <span class='fl'>120</span>, <span class='kw'>max_size</span> <span class='kw'>=</span> <span class='fl'>180</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>bam</th>
      <td><p>the input bam file</p></td>
    </tr>
    <tr>
      <th>targets</th>
      <td><p>The targets to restrict the windows within. Must have the columns chr, start and end.
In case of whole-genome, specify full chromosomes targets.</p></td>
    </tr>
    <tr>
      <th>tag</th>
      <td><p>the RG tag if the bam has more than one sample.</p></td>
    </tr>
    <tr>
      <th>window_size</th>
      <td><p>The window (bin) size to use within the targets</p></td>
    </tr>
    <tr>
      <th>step_size</th>
      <td><p>The step size to use in case of overlapping bins.</p></td>
    </tr>
    <tr>
      <th>min_size</th>
      <td><p>Restrict fragments to this minimum size.</p></td>
    </tr>
    <tr>
      <th>max_size</th>
      <td><p>Restrict fragments to this maximum size.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other parameters passed to get_fragment_size</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a data frame with the first three columns having the bins coordinates and
other columns having the WPS (raw and adjusted by coverage) and number of fragment ends (raw and adjusted by coverage).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Fragment length will extracted from the bam file according to the parameters passed to <code>get_fragment_size</code>, and the number of fragment ends,
and the Windowed Protection Score (WPS) will be computed in the binned input targets. Binning is done according to the window_size and step_size parameters.</p>
<p>WPS is defined as the number of fragments completely spanning a window (bin) minus
the number of fragments with an endpoint within the same window as reported by Snyder et al., Cell 2016.</p>
<p>The output include both the fragment end counts and the WPS in their raw format as well as after adjustment by coverage in the bin.</p>
<p>Minimum and maximum bounds of the fragment size are applied before computing WPS and fragment ends counts.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code>get_fragment_size</code> <code>bin_fragment_size</code> <code>summarize_fragment_size</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"targets"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"ctDNAtools"</span>)
<span class='no'>bamN1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"N1.bam"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"ctDNAtools"</span>)

<span class='co'>## basic usage</span>
<span class='fu'>analyze_fragmentation</span>(<span class='kw'>bam</span> <span class='kw'>=</span> <span class='no'>bamN1</span>, <span class='kw'>targets</span> <span class='kw'>=</span> <span class='no'>targets</span>)</div><div class='output co'>#&gt;       chr     start       end  WPS WPS_adjusted n_fragment_ends
#&gt; 1   chr14 106327303 106327423 -155   -1.0000000             155
#&gt; 2   chr14 106327308 106327428 -165   -1.0000000             165
#&gt; 3   chr14 106327313 106327433 -170   -1.0000000             170
#&gt; 4   chr14 106327318 106327438 -176   -1.0000000             176
#&gt; 5   chr14 106327323 106327443 -171   -0.9661017             174
#&gt; 6   chr14 106327328 106327448 -172   -0.9347826             179
#&gt; 7   chr14 106327333 106327453 -170   -0.9239130             177
#&gt; 8   chr14 106327338 106327458 -157   -0.8395722             172
#&gt; 9   chr14 106327343 106327463 -155   -0.8288770             171
#&gt; 10  chr14 106327348 106327468 -145   -0.7591623             172
#&gt; 11  chr14 106327353 106327473 -139   -0.7202073             168
#&gt; 12  chr14 106327358 106327478 -137   -0.7025641             166
#&gt; 13  chr14 106327363 106327483 -134   -0.6836735             171
#&gt; 14  chr14 106327368 106327488 -133   -0.6751269             165
#&gt; 15  chr14 106327373 106327493 -119   -0.5804878             164
#&gt; 16  chr14 106327378 106327498 -119   -0.5693780             167
#&gt; 17  chr14 106327383 106327503 -127   -0.6018957             169
#&gt; 18  chr14 106327388 106327508  -65   -0.3080569             138
#&gt; 19  chr14 106327393 106327513  -47   -0.2165899             135
#&gt; 20  chr14 106327398 106327518  -35   -0.1583710             133
#&gt; 21  chr14 106327403 106327523  -41   -0.1744681             138
#&gt; 22  chr14 106327408 106327528  -62   -0.2605042             151
#&gt; 23  chr14 106327413 106327533  -64   -0.2644628             165
#&gt; 24  chr14 106327418 106327538  -85   -0.3281853             175
#&gt; 25  chr14 106327423 106327543 -109   -0.4113208             187
#&gt; 26  chr14 106327428 106327548 -140   -0.5263158             206
#&gt; 27  chr14 106327433 106327553 -157   -0.5709091             217
#&gt; 28  chr14 106327438 106327558 -178   -0.6312057             233
#&gt; 29  chr14 106327443 106327563 -190   -0.6643357             239
#&gt; 30  chr14 106327448 106327568 -213   -0.7123746             256
#&gt; 31  chr14 106327453 106327573 -227   -0.7541528             264
#&gt; 32  chr14 106327458 106327578 -228   -0.7402597             270
#&gt; 33  chr14 106327463 106327583 -250   -0.7812500             287
#&gt; 34  chr14 106327468 106327588 -270   -0.8035714             304
#&gt; 35  chr14 106327473 106327593 -304   -0.8735632             328
#&gt; 36  chr14 106327478 106327598 -312   -0.8813559             333
#&gt; 37  chr14 106327483 106327603 -320   -0.8888889             343
#&gt; 38  chr14 106327488 106327608 -337   -0.9335180             350
#&gt; 39  chr14 106327493 106327613 -323   -0.8947368             343
#&gt; 40  chr14 106327498 106327618 -325   -0.8904110             349
#&gt; 41  chr14 106327503 106327623 -321   -0.8891967             341
#&gt; 42  chr14 106327508 106327628 -327   -0.9008264             345
#&gt; 43  chr14 106327513 106327633 -323   -0.8753388             346
#&gt; 44  chr14 106327518 106327638 -316   -0.8586957             343
#&gt; 45  chr14 106327523 106327643 -292   -0.8021978             334
#&gt; 46  chr14 106327528 106327648 -279   -0.7859155             317
#&gt; 47  chr14 106327533 106327653 -268   -0.7613636             310
#&gt; 48  chr14 106327538 106327658 -262   -0.7616279             310
#&gt; 49  chr14 106327543 106327663 -235   -0.7142857             285
#&gt; 50  chr14 106327548 106327668 -217   -0.7114754             261
#&gt; 51  chr14 106327553 106327673 -194   -0.6466667             249
#&gt; 52  chr14 106327558 106327678 -173   -0.5945017             233
#&gt; 53  chr14 106327563 106327683 -166   -0.5763889             228
#&gt; 54  chr14 106327568 106327688 -136   -0.4892086             207
#&gt; 55  chr14 106327573 106327693 -144   -0.5217391             216
#&gt; 56  chr14 106327578 106327698 -160   -0.5755396             222
#&gt; 57  chr14 106327583 106327703 -154   -0.5422535             223
#&gt; 58  chr14 106327588 106327708 -154   -0.5422535             226
#&gt; 59  chr14 106327593 106327713 -121   -0.4464945             199
#&gt; 60  chr14 106327598 106327718 -114   -0.4253731             192
#&gt; 61  chr14 106327603 106327723 -103   -0.3857678             188
#&gt; 62  chr14 106327608 106327728 -117   -0.4448669             191
#&gt; 63  chr14 106327613 106327733 -145   -0.5272727             211
#&gt; 64  chr14 106327618 106327738 -140   -0.5109489             207
#&gt; 65  chr14 106327623 106327743 -137   -0.4981818             207
#&gt; 66  chr14 106327628 106327748 -143   -0.5238095             209
#&gt; 67  chr14 106327633 106327753 -147   -0.5384615             214
#&gt; 68  chr14 106327638 106327758 -190   -0.6834532             235
#&gt; 69  chr14 106327643 106327763 -193   -0.6868327             238
#&gt; 70  chr14 106327648 106327768 -222   -0.7655172             258
#&gt; 71  chr14 106327653 106327773 -234   -0.7905405             265
#&gt; 72  chr14 106327658 106327778 -231   -0.7938144             262
#&gt; 73  chr14 106327663 106327783 -246   -0.8092105             276
#&gt; 74  chr14 106327668 106327788 -251   -0.8283828             278
#&gt; 75  chr14 106327673 106327793 -256   -0.8152866             285
#&gt; 76  chr14 106327678 106327798 -263   -0.8349206             289
#&gt; 77  chr14 106327683 106327803 -259   -0.8222222             287
#&gt; 78  chr14 106327688 106327808 -268   -0.8589744             290
#&gt; 79  chr14 106327693 106327813 -258   -0.8376623             284
#&gt; 80  chr14 106327698 106327818 -246   -0.8310811             271
#&gt; 81  chr14 106327703 106327823 -235   -0.8020478             268
#&gt; 82  chr14 106327708 106327828 -224   -0.7777778             256
#&gt; 83  chr14 106327713 106327833 -228   -0.7916667             258
#&gt; 84  chr14 106327718 106327838 -227   -0.7964912             257
#&gt; 85  chr14 106327723 106327843 -234   -0.8239437             259
#&gt; 86  chr14 106327728 106327848 -225   -0.8064516             256
#&gt; 87  chr14 106327733 106327853 -198   -0.7333333             235
#&gt; 88  chr14 106327738 106327858 -202   -0.7481481             239
#&gt; 89  chr14 106327743 106327863 -204   -0.7555556             237
#&gt; 90  chr14 106327748 106327868 -198   -0.7500000             234
#&gt; 91  chr14 106327753 106327873 -195   -0.7647059             225
#&gt; 92  chr14 106327758 106327878 -179   -0.7489540             209
#&gt; 93  chr14 106327763 106327883 -168   -0.7118644             202
#&gt; 94  chr14 106327768 106327888 -140   -0.6140351             188
#&gt; 95  chr14 106327773 106327893 -132   -0.5789474             180
#&gt; 96  chr14 106327778 106327898 -109   -0.4844444             173
#&gt; 97  chr14 106327783 106327903  -93   -0.4096916             166
#&gt; 98  chr14 106327788 106327908 -106   -0.4732143             166
#&gt; 99  chr14 106327793 106327913  -87   -0.3866667             156
#&gt; 100 chr14 106327798 106327918  -90   -0.4054054             156
#&gt; 101 chr14 106327803 106327923  -88   -0.3963964             156
#&gt; 102 chr14 106327808 106327928  -96   -0.4444444             157
#&gt; 103 chr14 106327813 106327933 -122   -0.5495495             174
#&gt; 104 chr14 106327818 106327938 -136   -0.6181818             187
#&gt; 105 chr14 106327823 106327943 -170   -0.7657658             197
#&gt; 106 chr14 106327828 106327948 -160   -0.7017544             198
#&gt; 107 chr14 106327833 106327953 -172   -0.7413793             202
#&gt; 108 chr14 106327838 106327958 -186   -0.7622951             217
#&gt; 109 chr14 106327843 106327963 -197   -0.7975709             224
#&gt; 110 chr14 106327848 106327968 -187   -0.7391304             224
#&gt; 111 chr14 106327853 106327973 -190   -0.7600000             220
#&gt; 112 chr14 106327858 106327978 -180   -0.7200000             220
#&gt; 113 chr14 106327863 106327983 -181   -0.7269076             216
#&gt; 114 chr14 106327868 106327988 -187   -0.7510040             218
#&gt; 115 chr14 106327873 106327993 -206   -0.8373984             228
#&gt; 116 chr14 106327878 106327998 -205   -0.8367347             226
#&gt; 117 chr14 106327883 106328003 -204   -0.8429752             223
#&gt; 118 chr14 106327888 106328008 -200   -0.8264463             228
#&gt; 119 chr14 106327893 106328013 -196   -0.8166667             218
#&gt; 120 chr14 106327898 106328018 -193   -0.8143460             216
#&gt; 121 chr14 106327903 106328023 -185   -0.7939914             214
#&gt; 122 chr14 106327908 106328028 -188   -0.8468468             206
#&gt; 123 chr14 106327913 106328033 -185   -0.8371041             205
#&gt; 124 chr14 106327918 106328038 -176   -0.8148148             199
#&gt; 125 chr14 106327923 106328043 -181   -0.8418605             198
#&gt; 126 chr14 106327928 106328048 -170   -0.8173077             190
#&gt; 127 chr14 106327933 106328053 -145   -0.7435897             173
#&gt; 128 chr14 106327938 106328058 -143   -0.7729730             164
#&gt; 129 chr14 106327943 106328063 -108   -0.6506024             139
#&gt; 130 chr14 106327948 106328068  -95   -0.5828221             133
#&gt; 131 chr14 106327953 106328073  -79   -0.5031847             123
#&gt; 132 chr14 106327958 106328078  -56   -0.3636364             107
#&gt; 133 chr14 106327963 106328083  -36   -0.2465753              91
#&gt; 134 chr14 106327968 106328088  -22   -0.1506849              93
#&gt; 135 chr14 106327973 106328093  -25   -0.1748252              84
#&gt; 136 chr14 106327978 106328098  -24   -0.1690141              83
#&gt; 137 chr14 106327983 106328103  -20   -0.1428571              80
#&gt; 138 chr14 106327988 106328108  -48   -0.3529412              95
#&gt; 139 chr14 106327993 106328113  -43   -0.3440000              86
#&gt; 140 chr14 106327998 106328118  -58   -0.4833333              89
#&gt; 141 chr14 106328003 106328123  -77   -0.6470588              98
#&gt; 142 chr14 106328008 106328128  -85   -0.7264957             101
#&gt; 143 chr14 106328013 106328133  -84   -0.7636364              97
#&gt; 144 chr14 106328018 106328138  -87   -0.7981651              99
#&gt; 145 chr14 106328023 106328143 -100   -0.9259259             106
#&gt; 146 chr14 106328028 106328148 -100   -1.0000000             100
#&gt; 147 chr14 106328033 106328153  -99   -1.0000000              99
#&gt; 148 chr14 106328038 106328158  -97   -1.0000000              97
#&gt; 149 chr14 106328043 106328163  -94   -1.0000000              94
#&gt; 150 chr14 106328048 106328168  -94   -1.0000000              94
#&gt; 151 chr14 106328053 106328173  -93   -1.0000000              93
#&gt; 152 chr14 106328058 106328178  -89   -1.0000000              89
#&gt; 153 chr14 106328063 106328183  -88   -1.0000000              88
#&gt; 154 chr14 106328068 106328188  -84   -1.0000000              84
#&gt; 155 chr14 106328073 106328193  -83   -1.0000000              83
#&gt; 156 chr14 106328078 106328198  -80   -1.0000000              80
#&gt; 157 chr14 106328083 106328203  -78   -1.0000000              78
#&gt; 158 chr14 106328088 106328208  -76   -1.0000000              76
#&gt; 159 chr14 106328093 106328213  -72   -1.0000000              72
#&gt; 160 chr14 106328098 106328218  -68   -1.0000000              68
#&gt; 161 chr14 106328103 106328223  -66   -1.0000000              66
#&gt; 162 chr14 106328108 106328228  -50   -1.0000000              50
#&gt; 163 chr14 106328113 106328233  -46   -1.0000000              46
#&gt; 164 chr14 106328118 106328238  -31   -1.0000000              31
#&gt; 165 chr14 106328123 106328243  -21   -1.0000000              21
#&gt; 166 chr14 106328128 106328248  -16   -1.0000000              16
#&gt; 167 chr14 106328133 106328253  -13   -1.0000000              13
#&gt; 168 chr14 106328138 106328258  -11   -1.0000000              11
#&gt; 169 chr14 106328143 106328263   -4   -1.0000000               4
#&gt; 170 chr14 106328148 106328268    0    0.0000000               0
#&gt; 171 chr14 106328153 106328273    0    0.0000000               0
#&gt; 172 chr14 106328158 106328278    0    0.0000000               0
#&gt; 173 chr14 106328163 106328283    0    0.0000000               0
#&gt; 174 chr14 106328168 106328288    0    0.0000000               0
#&gt;     n_fragment_ends_adjusted n_reads
#&gt; 1                  1.0000000     155
#&gt; 2                  1.0000000     165
#&gt; 3                  1.0000000     170
#&gt; 4                  1.0000000     176
#&gt; 5                  0.9830508     177
#&gt; 6                  0.9728261     184
#&gt; 7                  0.9619565     184
#&gt; 8                  0.9197861     187
#&gt; 9                  0.9144385     187
#&gt; 10                 0.9005236     191
#&gt; 11                 0.8704663     193
#&gt; 12                 0.8512821     195
#&gt; 13                 0.8724490     196
#&gt; 14                 0.8375635     197
#&gt; 15                 0.8000000     205
#&gt; 16                 0.7990431     209
#&gt; 17                 0.8009479     211
#&gt; 18                 0.6540284     211
#&gt; 19                 0.6221198     217
#&gt; 20                 0.6018100     221
#&gt; 21                 0.5872340     235
#&gt; 22                 0.6344538     238
#&gt; 23                 0.6818182     242
#&gt; 24                 0.6756757     259
#&gt; 25                 0.7056604     265
#&gt; 26                 0.7744361     266
#&gt; 27                 0.7890909     275
#&gt; 28                 0.8262411     282
#&gt; 29                 0.8356643     286
#&gt; 30                 0.8561873     299
#&gt; 31                 0.8770764     301
#&gt; 32                 0.8766234     308
#&gt; 33                 0.8968750     320
#&gt; 34                 0.9047619     336
#&gt; 35                 0.9425287     348
#&gt; 36                 0.9406780     354
#&gt; 37                 0.9527778     360
#&gt; 38                 0.9695291     361
#&gt; 39                 0.9501385     361
#&gt; 40                 0.9561644     365
#&gt; 41                 0.9445983     361
#&gt; 42                 0.9504132     363
#&gt; 43                 0.9376694     369
#&gt; 44                 0.9320652     368
#&gt; 45                 0.9175824     364
#&gt; 46                 0.8929577     355
#&gt; 47                 0.8806818     352
#&gt; 48                 0.9011628     344
#&gt; 49                 0.8662614     329
#&gt; 50                 0.8557377     305
#&gt; 51                 0.8300000     300
#&gt; 52                 0.8006873     291
#&gt; 53                 0.7916667     288
#&gt; 54                 0.7446043     278
#&gt; 55                 0.7826087     276
#&gt; 56                 0.7985612     278
#&gt; 57                 0.7852113     284
#&gt; 58                 0.7957746     284
#&gt; 59                 0.7343173     271
#&gt; 60                 0.7164179     268
#&gt; 61                 0.7041199     267
#&gt; 62                 0.7262357     263
#&gt; 63                 0.7672727     275
#&gt; 64                 0.7554745     274
#&gt; 65                 0.7527273     275
#&gt; 66                 0.7655678     273
#&gt; 67                 0.7838828     273
#&gt; 68                 0.8453237     278
#&gt; 69                 0.8469751     281
#&gt; 70                 0.8896552     290
#&gt; 71                 0.8952703     296
#&gt; 72                 0.9003436     291
#&gt; 73                 0.9078947     304
#&gt; 74                 0.9174917     303
#&gt; 75                 0.9076433     314
#&gt; 76                 0.9174603     315
#&gt; 77                 0.9111111     315
#&gt; 78                 0.9294872     312
#&gt; 79                 0.9220779     308
#&gt; 80                 0.9155405     296
#&gt; 81                 0.9146758     293
#&gt; 82                 0.8888889     288
#&gt; 83                 0.8958333     288
#&gt; 84                 0.9017544     285
#&gt; 85                 0.9119718     284
#&gt; 86                 0.9175627     279
#&gt; 87                 0.8703704     270
#&gt; 88                 0.8851852     270
#&gt; 89                 0.8777778     270
#&gt; 90                 0.8863636     264
#&gt; 91                 0.8823529     255
#&gt; 92                 0.8744770     239
#&gt; 93                 0.8559322     236
#&gt; 94                 0.8245614     228
#&gt; 95                 0.7894737     228
#&gt; 96                 0.7688889     225
#&gt; 97                 0.7312775     227
#&gt; 98                 0.7410714     224
#&gt; 99                 0.6933333     225
#&gt; 100                0.7027027     222
#&gt; 101                0.7027027     222
#&gt; 102                0.7268519     216
#&gt; 103                0.7837838     222
#&gt; 104                0.8500000     220
#&gt; 105                0.8873874     222
#&gt; 106                0.8684211     228
#&gt; 107                0.8706897     232
#&gt; 108                0.8893443     244
#&gt; 109                0.9068826     247
#&gt; 110                0.8853755     253
#&gt; 111                0.8800000     250
#&gt; 112                0.8800000     250
#&gt; 113                0.8674699     249
#&gt; 114                0.8755020     249
#&gt; 115                0.9268293     246
#&gt; 116                0.9224490     245
#&gt; 117                0.9214876     242
#&gt; 118                0.9421488     242
#&gt; 119                0.9083333     240
#&gt; 120                0.9113924     237
#&gt; 121                0.9184549     233
#&gt; 122                0.9279279     222
#&gt; 123                0.9276018     221
#&gt; 124                0.9212963     216
#&gt; 125                0.9209302     215
#&gt; 126                0.9134615     208
#&gt; 127                0.8871795     195
#&gt; 128                0.8864865     185
#&gt; 129                0.8373494     166
#&gt; 130                0.8159509     163
#&gt; 131                0.7834395     157
#&gt; 132                0.6948052     154
#&gt; 133                0.6232877     146
#&gt; 134                0.6369863     146
#&gt; 135                0.5874126     143
#&gt; 136                0.5845070     142
#&gt; 137                0.5714286     140
#&gt; 138                0.6985294     136
#&gt; 139                0.6880000     125
#&gt; 140                0.7416667     120
#&gt; 141                0.8235294     119
#&gt; 142                0.8632479     117
#&gt; 143                0.8818182     110
#&gt; 144                0.9082569     109
#&gt; 145                0.9814815     108
#&gt; 146                1.0000000     100
#&gt; 147                1.0000000      99
#&gt; 148                1.0000000      97
#&gt; 149                1.0000000      94
#&gt; 150                1.0000000      94
#&gt; 151                1.0000000      93
#&gt; 152                1.0000000      89
#&gt; 153                1.0000000      88
#&gt; 154                1.0000000      84
#&gt; 155                1.0000000      83
#&gt; 156                1.0000000      80
#&gt; 157                1.0000000      78
#&gt; 158                1.0000000      76
#&gt; 159                1.0000000      72
#&gt; 160                1.0000000      68
#&gt; 161                1.0000000      66
#&gt; 162                1.0000000      50
#&gt; 163                1.0000000      46
#&gt; 164                1.0000000      31
#&gt; 165                1.0000000      21
#&gt; 166                1.0000000      16
#&gt; 167                1.0000000      13
#&gt; 168                1.0000000      11
#&gt; 169                1.0000000       4
#&gt; 170                0.0000000       0
#&gt; 171                0.0000000       0
#&gt; 172                0.0000000       0
#&gt; 173                0.0000000       0
#&gt; 174                0.0000000       0</div><div class='input'>
<span class='co'>## more options</span>
<span class='fu'>analyze_fragmentation</span>(
  <span class='kw'>bam</span> <span class='kw'>=</span> <span class='no'>bamN1</span>, <span class='kw'>targets</span> <span class='kw'>=</span> <span class='no'>targets</span>,
  <span class='kw'>step_size</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>window_size</span> <span class='kw'>=</span> <span class='fl'>50</span>
)</div><div class='output co'>#&gt;      chr     start       end WPS WPS_adjusted n_fragment_ends
#&gt; 1  chr14 106327373 106327423 -51  -0.32903226             104
#&gt; 2  chr14 106327383 106327433 -46  -0.27058824             108
#&gt; 3  chr14 106327393 106327443  37   0.20903955              71
#&gt; 4  chr14 106327403 106327453  74   0.40217391              55
#&gt; 5  chr14 106327413 106327463  93   0.49732620              54
#&gt; 6  chr14 106327423 106327473 117   0.60621762              38
#&gt; 7  chr14 106327433 106327483 134   0.68367347              33
#&gt; 8  chr14 106327443 106327493 131   0.63902439              38
#&gt; 9  chr14 106327453 106327503 117   0.55450237              47
#&gt; 10 chr14 106327463 106327513 113   0.52073733              54
#&gt; 11 chr14 106327473 106327523  87   0.37021277              76
#&gt; 12 chr14 106327483 106327533  53   0.22362869              97
#&gt; 13 chr14 106327493 106327543   0   0.00000000             129
#&gt; 14 chr14 106327503 106327553 -55  -0.21568627             156
#&gt; 15 chr14 106327513 106327563 -88  -0.33333333             177
#&gt; 16 chr14 106327523 106327573 -93  -0.34572491             187
#&gt; 17 chr14 106327533 106327583 -89  -0.33085502             181
#&gt; 18 chr14 106327543 106327593 -83  -0.30627306             179
#&gt; 19 chr14 106327553 106327603 -56  -0.22047244             160
#&gt; 20 chr14 106327563 106327613 -41  -0.17012448             141
#&gt; 21 chr14 106327573 106327623 -14  -0.05982906             125
#&gt; 22 chr14 106327583 106327633  13   0.05439331             114
#&gt; 23 chr14 106327593 106327643  73   0.32444444              78
#&gt; 24 chr14 106327603 106327653 103   0.45374449              62
#&gt; 25 chr14 106327613 106327663  84   0.38181818              69
#&gt; 26 chr14 106327623 106327673  98   0.44545455              61
#&gt; 27 chr14 106327633 106327683 109   0.48878924              58
#&gt; 28 chr14 106327643 106327693  98   0.43750000              68
#&gt; 29 chr14 106327653 106327703  60   0.25423729              91
#&gt; 30 chr14 106327663 106327713  42   0.18750000              92
#&gt; 31 chr14 106327673 106327723  35   0.15837104              96
#&gt; 32 chr14 106327683 106327733 -12  -0.05084746             125
#&gt; 33 chr14 106327693 106327743  -9  -0.03896104             122
#&gt; 34 chr14 106327703 106327753   4   0.01886792             112
#&gt; 35 chr14 106327713 106327763 -27  -0.13043478             118
#&gt; 36 chr14 106327723 106327773 -71  -0.33333333             142
#&gt; 37 chr14 106327733 106327783 -49  -0.22580645             135
#&gt; 38 chr14 106327743 106327793 -56  -0.25000000             140
#&gt; 39 chr14 106327753 106327803 -56  -0.26415094             134
#&gt; 40 chr14 106327763 106327813 -27  -0.14136126             109
#&gt; 41 chr14 106327773 106327823   2   0.01136364              87
#&gt; 42 chr14 106327783 106327833  36   0.19565217              76
#&gt; 43 chr14 106327793 106327843  51   0.27567568              67
#&gt; 44 chr14 106327803 106327853  44   0.23655914              72
#&gt; 45 chr14 106327813 106327863  36   0.19565217              74
#&gt; 46 chr14 106327823 106327873  46   0.26136364              65
#&gt; 47 chr14 106327833 106327883  54   0.30681818              61
#&gt; 48 chr14 106327843 106327893  56   0.30769231              65
#&gt; 49 chr14 106327853 106327903  61   0.34078212              63
#&gt; 50 chr14 106327863 106327913  56   0.32183908              59
#&gt; 51 chr14 106327873 106327923  46   0.26436782              64
#&gt; 52 chr14 106327883 106327933  16   0.09195402              81
#&gt; 53 chr14 106327893 106327943 -25  -0.13812155             104
#&gt; 54 chr14 106327903 106327953 -43  -0.22751323             118
#&gt; 55 chr14 106327913 106327963 -68  -0.34343434             135
#&gt; 56 chr14 106327923 106327973 -70  -0.34653465             136
#&gt; 57 chr14 106327933 106327983 -45  -0.23809524             120
#&gt; 58 chr14 106327943 106327993 -29  -0.18012422              99
#&gt; 59 chr14 106327953 106328003  -7  -0.04458599              85
#&gt; 60 chr14 106327963 106328013  28   0.19178082              59
#&gt; 61 chr14 106327973 106328023  47   0.32867133              51
#&gt; 62 chr14 106327983 106328033  46   0.32857143              47
#&gt; 63 chr14 106327993 106328043  53   0.42400000              37
#&gt; 64 chr14 106328003 106328053  67   0.56302521              27
#&gt; 65 chr14 106328013 106328063  66   0.60000000              22
#&gt; 66 chr14 106328023 106328073  58   0.53703704              27
#&gt; 67 chr14 106328033 106328083  57   0.57575758              21
#&gt; 68 chr14 106328043 106328093  50   0.53191489              22
#&gt; 69 chr14 106328053 106328103  39   0.41935484              27
#&gt; 70 chr14 106328063 106328113   4   0.04545455              43
#&gt; 71 chr14 106328073 106328123 -41  -0.49397590              62
#&gt; 72 chr14 106328083 106328133 -52  -0.66666667              65
#&gt; 73 chr14 106328093 106328143 -64  -0.88888889              70
#&gt;    n_fragment_ends_adjusted n_reads
#&gt; 1                 0.6709677     155
#&gt; 2                 0.6352941     170
#&gt; 3                 0.4011299     177
#&gt; 4                 0.2989130     184
#&gt; 5                 0.2887701     187
#&gt; 6                 0.1968912     193
#&gt; 7                 0.1683673     196
#&gt; 8                 0.1853659     205
#&gt; 9                 0.2227488     211
#&gt; 10                0.2488479     217
#&gt; 11                0.3234043     235
#&gt; 12                0.4092827     237
#&gt; 13                0.5039062     256
#&gt; 14                0.6117647     255
#&gt; 15                0.6704545     264
#&gt; 16                0.6951673     269
#&gt; 17                0.6728625     269
#&gt; 18                0.6605166     271
#&gt; 19                0.6299213     254
#&gt; 20                0.5850622     241
#&gt; 21                0.5341880     234
#&gt; 22                0.4769874     239
#&gt; 23                0.3466667     225
#&gt; 24                0.2731278     227
#&gt; 25                0.3136364     220
#&gt; 26                0.2772727     220
#&gt; 27                0.2600897     223
#&gt; 28                0.3035714     224
#&gt; 29                0.3855932     236
#&gt; 30                0.4107143     224
#&gt; 31                0.4343891     221
#&gt; 32                0.5296610     236
#&gt; 33                0.5281385     231
#&gt; 34                0.5283019     212
#&gt; 35                0.5700483     207
#&gt; 36                0.6666667     213
#&gt; 37                0.6221198     217
#&gt; 38                0.6250000     224
#&gt; 39                0.6320755     212
#&gt; 40                0.5706806     191
#&gt; 41                0.4943182     176
#&gt; 42                0.4130435     184
#&gt; 43                0.3621622     185
#&gt; 44                0.3870968     186
#&gt; 45                0.4021739     184
#&gt; 46                0.3693182     176
#&gt; 47                0.3465909     176
#&gt; 48                0.3571429     182
#&gt; 49                0.3519553     179
#&gt; 50                0.3390805     174
#&gt; 51                0.3678161     174
#&gt; 52                0.4655172     174
#&gt; 53                0.5745856     181
#&gt; 54                0.6243386     189
#&gt; 55                0.6818182     198
#&gt; 56                0.6732673     202
#&gt; 57                0.6349206     189
#&gt; 58                0.6149068     161
#&gt; 59                0.5414013     157
#&gt; 60                0.4041096     146
#&gt; 61                0.3566434     143
#&gt; 62                0.3357143     140
#&gt; 63                0.2960000     125
#&gt; 64                0.2268908     119
#&gt; 65                0.2000000     110
#&gt; 66                0.2500000     108
#&gt; 67                0.2121212      99
#&gt; 68                0.2340426      94
#&gt; 69                0.2903226      93
#&gt; 70                0.4886364      88
#&gt; 71                0.7469880      83
#&gt; 72                0.8333333      78
#&gt; 73                0.9722222      72</div><div class='input'># }

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Amjad Alkodsi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


